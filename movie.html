<!DOCTYPE html>
<html>

<head>
    <title>Movies Now</title>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
    <div id="menu">
    </div>
    <script src="./scripts/header.js"></script>
    <script type="text/javascript" src="./scripts/mobile.js"></script>

    <video id="video" width="80%" height="720" controls>
        <source id="videoSrc" src="" type="video/mp4">
        <!-- <source src="movie.ogg" type="video/ogg"> -->
    </video>

    <script>
        console.log(window.location.search)
        let params = new URLSearchParams(window.location.search)
        console.log(params.get("id"))

        var movieId = params.get("id");
        var linkS = "https://api.adjaranet.com/api/v1/movies/"
        var linkE = "/season-files/0"
        var param = "?source=adjaranet"
        var request = new XMLHttpRequest();

        request.open('GET', linkS + movieId + linkE + param, true);
        request.onload = function () {

            if (request.status >= 200 && request.status < 400) {
                var video = document.getElementById('video');
                video.pause();

                var data = JSON.parse(this.response);
                var firsVideoData = data.data[0].files[0]
                // console.log(firsVideoData["lang"])
                // console.log(firsVideoData.files[0].src)
                var videoSrcLink = firsVideoData.files[0].src
                document.getElementById('videoSrc').setAttribute("src", videoSrcLink);
                
                video.load();
            } else {
                console.log('error')
            }
        }
        request.send()
    </script>
</body>

</html>